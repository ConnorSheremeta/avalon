<div class="row-fluid">
  <div class="span8" id="left_column">
      <%= render 'video_player' %>
      <%= render 'sections', 
        locals: {mediaobject: @mediaobject,
                 sections: @masterFiles,
                 activeStream: @currrentStream} %>
  </div>

  <div class="span4" id="right-column">
    <%= render 'administrative_links' %>

    <div id="metadata_container" class="">
      <section id="metadata"><%= render "metadata_display" %></section>
    </div>
  </div>

  <div class=row-fluid">  
      <div class="span8">
        <div id="permalink" class="alert alert-success">
          <h4 class="alert-heading">Permalink</h4>
          <p>To share this item with others use the following canonical link</p>
          <address><%= link_to media_object_url(@mediaobject.pid) %></address>
        </div>
      </div>
    </div>
  </div>
</div>

<% content_for :title do %>
  Preview -
  <% unless @mediaobject.title.blank? %>
  <%= @mediaobject.title %> (<%= @mediaobject.pid %>)
  <% else %>
    <%= @mediaobject.pid %>
  <% end %>
<% end %>

<% content_for :page_scripts do %>
  <%# Since there are no streams if @currentStream is nil then don't bother including any of the following content %>
  <%= javascript_include_tag 'switch_streams' %>
  <%= javascript_include_tag 'swfobject' %>
  <%= javascript_include_tag 'avalonplayer' %>

  <script>
    $(function(){
      if ($("#nojs").length > 0) {
        currentPlayer = avalonPlayer("#player", 
                   { hls: <%= @currentStreamInfo[:stream_hls].to_json.html_safe %>,
                     poster: "<%= @currentStreamInfo[:poster_image] %>", 
                     mediaPackageId: "<%= @currentStreamInfo[:mediapackage_id] %>", 
                     flash: <%= @currentStreamInfo[:stream_flash].to_json.html_safe %> });
      }
    })
  </script>
<% end %>
