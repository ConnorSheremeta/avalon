<html>
  <head>
    <title><%= @mediaobject.title %> (<%= @mediaobject.pid %>)</title>
  </head>

  <body>
    <h1><%= @mediaobject.title %></h1>

    <%# Here comes the hack to HTTP live stream. This naively assumes that
        you are using a MP4 live stream instead of FLV %>
        <% format = case @currentStream.media_type
            when 'Moving image'
             'video'
            when 'Sound'
             'audio'
           else
             'other'
           end %>
        <% stream = @currentStream.derivatives.first.streaming_url(true, format) %>
    <p>Loading stream directly from <% stream %></p>
    <video width="640" height="480" controls="controls">
      <source src="<%= stream %>" type="video/mp4" %>
      Your browser does not support HTML5 video (MPEG4)
    </video>

    <hr />
    <h2>Browser support for the &lt;video&gt; tag</h2>
    <table>
      <thead>
        <tr>
          <td>Format</td>
          <td>Supported?</td>
        <tr/>
        </thead>
        <tbody>
          <tr>
            <td>HTTP Live Streaming</td>
            <td id="hls"> - </td>
          </tr>  
          <tr>
            <td>H.264 MPEG4</td>
            <td id="x264"> - </td>
          </tr>
        </tbody>
    </table>
  </body>
  <script>
     vtag = $('video');
     hls_value = vtag.canPlay('application/vnd.apple.mpegurl');
     $('#hls').text(hls_value);

     x264_value = vtag.canPlay('video/mp4');
     $('x264').text(x264_value); 
  </script>
</html>

