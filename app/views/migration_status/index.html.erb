<ol class="breadcrumb">
  <li class="active">Migration Report</li>
</ol>
<table class="table table-striped table-hover table-condensed">
  <tr>
    <th class="nowrap">Class&nbsp;Name</th>
    <th class="text-right nowrap">Completed</th>
    <th class="text-right nowrap">Failed</th>
    <th class="text-right nowrap">Waiting</th>
    <th class="text-right nowrap">In Progress</th>
    <th class="text-right nowrap">Total</th>
  </tr>
  <% @counts.keys.each do |klass| %>
    <tr>
      <td><%= link_to klass, admin_migration_report_by_class_path(class: klass) %></td>
      <td class="text-right"><%= status_link(klass, 'completed') %></td>
      <td class="text-right"><%= status_link(klass, 'failed') %></td>
      <td class="text-right"><%= status_link(klass, 'waiting') %></td>
      <td class="text-right"><%= @counts[klass]['in progress'] %></td>
      <td class="text-right"><%= status_link(klass, 'total', nil) %></td>
    </tr>
  <% end %>
  <% totals = @counts.values.inject(Hash.new(0)) { |h,l| l.each_pair { |k,v| h[k] += v }; h } %>
  <tr>
    <td><strong>Total</strong></td>
    <% ['completed','failed','waiting','in progress','total'].each do |status| %>
    <td class="text-right"><strong><%= totals[status] %></strong></td>
    <% end %>
  </tr>
</table>
